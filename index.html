<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard</title>

<style>
:root{
 --bg:#f4f6f9;
 --card:#ffffff;
 --text:#222;
 --primary:#1976d2;
 --shadow:
  0 -6px 20px rgba(0,0,0,.08),
  0 12px 30px rgba(0,0,0,.18);
}
body.dark{
 --bg:#0f0f0f;
 --card:#1c1c1c;
 --text:#eee;
 --primary:#64b5f6;
 --shadow:
  0 -6px 20px rgba(0,0,0,.25),
  0 14px 35px rgba(0,0,0,.55);
}
body{
 margin:0;
 font-family:Segoe UI, Tahoma;
 background:var(--bg);
 color:var(--text);
 overflow:hidden;
}

/* ================= BACKGROUND ================= */
.bg{
 position:fixed;
 inset:0;
 z-index:0;
 pointer-events:none;
}
.bg .stars{
 position:absolute;
 width:200%;
 height:200%;
 background:url('https://i.imgur.com/9yG8g.gif');
 background-size:cover;
 opacity:.12;
 animation:rotateStars 200s linear infinite;
}
.bg .glow{
 position:absolute;
 width:500px;
 height:500px;
 top:50%;
 left:50%;
 transform:translate(-50%,-50%);
 background:radial-gradient(circle, rgba(0,191,255,.45), transparent 70%);
 filter:blur(70px);
 animation:glowMove 15s ease-in-out infinite;
}
.bg img{
 position:absolute;
 top:50%;
 left:50%;
 width:50%;
 max-width:600px;
 transform:translate(-50%,-50%) scale(.9);
 animation:logoMove 15s ease-in-out infinite;
 opacity:.85;
}

@keyframes rotateStars{from{transform:rotate(0)}to{transform:rotate(360deg)}}
@keyframes glowMove{
 0%,100%{transform:translate(-50%,-50%) scale(.9)}
 50%{transform:translate(-40%,-50%) scale(1.2)}
}
@keyframes logoMove{
 0%{opacity:0;transform:translate(-50%,-50%) scale(.8)}
 20%{opacity:1;transform:translate(-50%,-50%) scale(1.1)}
 50%{opacity:0;transform:translate(120%,-50%) scale(1)}
 51%{transform:translate(-120%,-50%) scale(.8)}
 80%{opacity:1;transform:translate(-50%,-50%) scale(1.15)}
}

/* ================= FLOAT BACK BUTTON ================= */
.back-btn{
 position:fixed;
 top:18px;
 right:18px;
 z-index:99;
 background:var(--card);
 box-shadow:var(--shadow);
 border-radius:50%;
 width:46px;
 height:46px;
 display:flex;
 align-items:center;
 justify-content:center;
 font-size:22px;
 cursor:pointer;
 transition:.25s;
}
.back-btn:hover{
 background:var(--primary);
 color:#fff;
}

/* ================= LOGIN ================= */
.login{
 position:relative;
 z-index:2;
 max-width:420px;
 margin:90px auto;
 background:var(--card);
 padding:35px;
 border-radius:22px;
 box-shadow:var(--shadow);
 text-align:center;
}
.login img{width:120px;margin-bottom:15px}
.login h2{color:var(--primary)}
.login input{
 width:100%;
 padding:14px;
 margin:10px 0;
 border-radius:14px;
 border:1px solid #ccc;
}
.login button{
 width:100%;
 padding:14px;
 border-radius:16px;
 border:0;
 background:var(--primary);
 color:#fff;
 font-size:16px;
}
.msg{margin-top:12px;color:red;font-weight:bold}

/* ================= DASHBOARD ================= */
.dashboard{
 display:none;
 position:relative;
 z-index:2;
 height:100vh;
 overflow:auto;
 padding:25px;
}
.top{
 display:flex;
 justify-content:space-between;
 align-items:center;
 flex-wrap:wrap;
 gap:15px;
 margin-bottom:25px;
}

/* USER INFO */
.user-info{display:flex;gap:15px;flex-wrap:wrap}
.info-card{
 background:var(--card);
 padding:14px 18px;
 border-radius:18px;
 box-shadow:var(--shadow);
 min-width:170px;
}
.info-card small{display:block;color:#888}

/* SETTINGS */
.settings{position:relative}
.settings button{
 background:var(--card);
 border:0;
 padding:10px 14px;
 border-radius:14px;
 box-shadow:var(--shadow);
 font-size:18px;
 cursor:pointer;
}
.menu{
 display:none;
 position:absolute;
 left:0;
 top:50px;
 background:var(--card);
 border-radius:16px;
 box-shadow:var(--shadow);
 overflow:hidden;
}
.menu div{
 padding:14px 20px;
 cursor:pointer;
}
.menu div:hover{background:rgba(0,0,0,.05)}

/* PAGES */
.pages{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
 gap:20px;
}
.section{
 grid-column:1/-1;
 font-weight:bold;
 color:var(--primary);
 margin-top:35px;
 font-size:18px;
}
.page{
 background:var(--card);
 padding:24px;
 border-radius:22px;
 box-shadow:var(--shadow);
 text-align:center;
 cursor:pointer;
 transition:.25s;
}
.page:hover{
 transform:translateY(-6px);
 background:var(--primary);
 color:#fff;
}

/* MODAL */
.modal{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.4);
 display:none;
 align-items:center;
 justify-content:center;
 z-index:9;
}
.modal-box{
 background:var(--card);
 padding:30px;
 border-radius:22px;
 box-shadow:var(--shadow);
 width:340px;
}
.modal-box input,
.modal-box button{
 width:100%;
 padding:14px;
 margin-top:12px;
 border-radius:14px;
 border:1px solid #ccc;
}
.modal-box button{
 border:0;
 background:var(--primary);
 color:#fff;
}

/* ================= RESPONSIVE ================= */
@media(max-width:768px){
 body{overflow:auto}
 .login{margin:40px 16px}
 .dashboard{padding:18px}
 .top{flex-direction:column}
 .user-info{flex-direction:column}
 .info-card{width:100%;text-align:center}
 .pages{grid-template-columns:1fr}
}
</style>
</head>

<body>

<div class="bg" id="bg">
 <div class="stars"></div>
 <div class="glow"></div>
 <img src="https://lh3.googleusercontent.com/pw/AP1GczMiRkDmMrZOPEMglikz95yOdSkrhKpx46bQE-TsNpqt8Cc-zZ53W7zBe3vVum7ljY-ynEQB8PIlpgmDjkrfSIv5JG-j1qGCNS-uk_iGnmMaql_MuCwKC7F4G7gd1Hn4GRWdyJ0L9HYHt4HLpnTtMQxH=w2499-h1214-s-no-gm">
</div>

<div class="back-btn" onclick="history.back()">â¬…ï¸</div>

<!-- LOGIN -->
<div class="login" id="loginBox">
<img src="https://lh3.googleusercontent.com/pw/AP1GczMiRkDmMrZOPEMglikz95yOdSkrhKpx46bQE-TsNpqt8Cc-zZ53W7zBe3vVum7ljY-ynEQB8PIlpgmDjkrfSIv5JG-j1qGCNS-uk_iGnmMaql_MuCwKC7F4G7gd1Hn4GRWdyJ0L9HYHt4HLpnTtMQxH=w2499-h1214-s-no-gm">
<h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
<input id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="password" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
<div class="msg" id="msg"></div>
</div>

<!-- DASHBOARD -->
<div class="dashboard" id="dashboard">
 <div class="top">
  <div class="user-info" id="info"></div>
  <div class="settings">
   <button onclick="toggleMenu()">âš™ï¸</button>
   <div class="menu" id="menu">
    <div onclick="openPass()">ğŸ”‘ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</div>
    <div onclick="toggleDark()">ğŸŒ™ Dark Mode</div>
    <div onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</div>
   </div>
  </div>
 </div>
 <div class="pages" id="pages"></div>
</div>

<!-- CHANGE PASSWORD -->
<div class="modal" id="passModal">
 <div class="modal-box">
  <h3>ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</h3>
  <input id="newPass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">
  <button onclick="changePass()">Ø­ÙØ¸</button>
 </div>
</div>

<script>
const DB="https://hr-mange-1ec00-default-rtdb.firebaseio.com";
let currentUser=null;

function login(){
 msg.innerHTML="";
 const u=username.value.trim().toLowerCase();
 const p=password.value.trim();
 if(!u||!p){msg.innerHTML="âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";return;}

 fetch(DB+"/USAR.json").then(r=>r.json()).then(d=>{
  for(const id in d){
   if(String(d[id].username).toLowerCase()==u && String(d[id].password)==p){
    currentUser={...d[id],_id:id};
    localStorage.setItem("session",JSON.stringify(currentUser));
    loadDashboard();
    return;
   }
  }
  msg.innerHTML="âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
 });
}

function loadDashboard(){
 loginBox.style.display="none";
 dashboard.style.display="block";
 info.innerHTML=`
 <div class="info-card"><small>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</small>${currentUser.username}</div>
 <div class="info-card"><small>Ø§Ù„Ù…Ø¯ÙŠØ±</small>${currentUser.managerName}</div>
 <div class="info-card"><small>Ø§Ù„ÙØ±Ø¹</small>${currentUser.branchName}</div>`;
 loadPages();
}

function loadPages(){
 pages.innerHTML="";
 fetch(DB+"/Pages.json").then(r=>r.json()).then(data=>{
  for(const s in data){
   let list="",has=false;
   for(const p in data[s].items){
    const key=(data[s].title||s)+"|"+data[s].items[p].name;
    if(currentUser.pages?.[key]){
     has=true;
     list+=`<div class="page" onclick="location.href='${data[s].items[p].url}'">${data[s].items[p].name}</div>`;
    }
   }
   if(has) pages.innerHTML+=`<div class="section">${data[s].title||s}</div>${list}`;
  }
 });
}

function toggleMenu(){menu.style.display=menu.style.display=="block"?"none":"block"}
function toggleDark(){document.body.classList.toggle("dark")}
function logout(){
 localStorage.removeItem("session");
 location.reload();
}
function openPass(){passModal.style.display="flex"}
function changePass(){
 fetch(`${DB}/USAR/${currentUser._id}.json`,{
  method:"PATCH",
  headers:{'Content-Type':'application/json'},
  body:JSON.stringify({password:newPass.value})
 }).then(()=>{alert("ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ±");passModal.style.display="none"});
}

const s=localStorage.getItem("session");
if(s){currentUser=JSON.parse(s);loadDashboard();}
</script>

</body>
</html>

